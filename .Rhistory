source("http://bioconductor.org/biocLite.R")
#install packages
biocLite(c("affy"))
library(oligo)
library(impute)
biocLite(c("affy", "oligo", "imputue"))
biocLite(c("affy", "oligo", "impute"))
library(oligo)
library(impute)
baseDir <- "~/GitHub/Cdiff_expression/remove bad features"
xys <- list.files(baseDir, pattern = ".xys", full.names = TRUE)[1]
xys
baseDir <- "~/GitHub/Cdiff_expression"
ndf <- list.files(baseDir, pattern = ".ndf", full.names = TRUE)
seed <- new("NgsExpressionPDInfoPkgSeed", ndfFile = ndf, xysFile = xys, biocViews = "AnnotationData", organism = "sunflower", species = "Helianthus annuus")
library(pdInfoBuilder)
biocLite(c("affy", "oligo", "impute", "pdInfoBuilder"))
library(oligo)
library(impute)
library(pdInfoBuilder)
seed <- new("NgsExpressionPDInfoPkgSeed", ndfFile = ndf, xysFile = xys, biocViews = "AnnotationData", organism = "knapweed", species = "Centaurea diffusa")
makePdInfoPackage(seed, destDir = baseDir)
install.packages("~/GitHub/Cdiff_expression/pd.110405.cdiffusa.lz.exp/", repos=NULL, type="source")
xys.files<-list.xysfiles("~/GitHub/Cdiff_expression/remove bad features", full.names=TRUE)
Cdifexpr<-read.xysfiles(xys.files)
data<-exprs(Cdifexpr)
data2<-data[apply(data,1,function(x)any(!is.na(x))),]
data3<-data[apply(data,1,function(x)any(is.na(x))),]
head(data2)
head(data3)
data2<-data[rowSums(is.na(data)) < 108, ,drop=FALSE] #number here should match the number of samples (columns) in the data frame
?impute.knn
knnout<-impute.knn(data2, k=10, rowmax=0.5, colmax=0.8, maxp=1500, rng.seed=362436069) #imputing with default values
allkn<-knnout$data
write.table(allkn, file="~/GitHub/Cdiff_expression/remove bad features/knn_replaced.txt", quote=F, sep="\t")
